Untested and trashy commit code... I hope this works...